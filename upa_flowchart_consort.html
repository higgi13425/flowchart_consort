<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter Higgins">

<title>Building a CONSORT diagram with the {flowchart} package for Upa Phase 3 for UC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="upa_flowchart_consort_files/libs/clipboard/clipboard.min.js"></script>
<script src="upa_flowchart_consort_files/libs/quarto-html/quarto.js"></script>
<script src="upa_flowchart_consort_files/libs/quarto-html/popper.min.js"></script>
<script src="upa_flowchart_consort_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="upa_flowchart_consort_files/libs/quarto-html/anchor.min.js"></script>
<link href="upa_flowchart_consort_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="upa_flowchart_consort_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="upa_flowchart_consort_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="upa_flowchart_consort_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="upa_flowchart_consort_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Building a CONSORT diagram with the {flowchart} package for Upa Phase 3 for UC</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Peter Higgins </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example"><strong>Example</strong></h2>
<p>We will build a 2nd example dataset for the {flowchart} package. This dataset will be from the phase 3 Upa study for UC. The data will be simulated to match the structure of the data from the Upa study to reproduce the CONSORT diagram. Original paper here: <a href="https://www.gastrojournal.org/article/S0016-5085(20)30241-9/fulltext?referrer=https%3A%2F%2Fpubmed.ncbi.nlm.nih.gov%2F" class="uri">https://www.gastrojournal.org/article/S0016-5085(20)30241-9/fulltext?referrer=https%3A%2F%2Fpubmed.ncbi.nlm.nih.gov%2F</a></p>
<p>Our goal is to replicate Figure 1.</p>
<section id="note-updates-since-the-original-example-package" class="level3">
<h3 class="anchored" data-anchor-id="note-updates-since-the-original-example-package">NOTE: updates since the original example package</h3>
<ul>
<li>added b0x_corners = “sharp” to the fc_draw() function to make the boxes have sharp corners</li>
<li>added the function fc_view(“fc”) to view the flowchart object table.</li>
<li>more comments in the issues section of https://github.com/bruigtp/flowchart/issues, search for ‘higgi13425’ and look at other updates.</li>
<li>Look at package for news and updates.</li>
</ul>
<p>Dataset construction will be as follows:</p>
<ol type="1">
<li><p>446 participants will be simulated and assessed for eligibility</p></li>
<li><p>196 participants will be excluded</p></li>
<li><p>250 participants will be randomized to the study</p></li>
<li><p>46-56 participants will be assigned to the 5 treatment groups</p></li>
<li><p>2-6 from each arm will discontinue treatment</p></li>
<li><p>41-50 from each arm will complete the study</p></li>
</ol>
<p>We will use the data provided in Figure 1, and will not use any patient identifying data.</p>
<p>The variables in the dataset should include:</p>
<ul>
<li><p>id: participant identifier</p></li>
<li><p>inclusion_crit: inclusion criteria met (Yes/No)</p></li>
<li><p>exclusion_crit: exclusion criteria met (Yes/No) Other reasons for exclusion, including:</p></li>
<li><p>withdrew_consent: withdrew consent (Yes/No)</p></li>
<li><p>lost_to_follow_up: lost to follow-up (Yes/No)</p></li>
<li><p>other_reasons: other reasons for exclusion (Yes/No)</p></li>
<li><p>group (treatment group)</p></li>
<li><p>completed: completed the study (Yes/No) Reasons for non-completion, including:</p></li>
<li><p>adverse_event (Yes/No)</p></li>
<li><p>lack_of_efficacy (Yes/No)</p></li>
<li><p>other_reasons (Yes/No)</p></li>
<li><p>itt: intention to treat (Yes/No)</p></li>
<li><p>reason_itt: reason for not being included in the intention to treat analysis</p></li>
<li><p>pp: per protocol (Yes/No)</p></li>
<li><p>reason_pp: reason for not being included in the per protocol analysis</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">446</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">inclusion_crit =</span> <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">446</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">exclusion_crit =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">274</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">172</span>)),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">withdrew_consent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">257</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">17</span>), <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">172</span>)),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">lost_to_follow_up =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">255</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">189</span>)), </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">other_reasons =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">250</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">191</span>)), </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Placebo"</span>, <span class="dv">46</span>), <span class="fu">rep</span>(<span class="st">"Upa 7.5 mg QD"</span>, <span class="dv">47</span>), <span class="fu">rep</span>(<span class="st">"Upa 15 mg QD"</span>, <span class="dv">49</span>), <span class="fu">rep</span>(<span class="st">"Upa 30 mg QD"</span>, <span class="dv">52</span>), <span class="fu">rep</span>(<span class="st">"Upa 45 mg QD"</span>, <span class="dv">56</span>), <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">196</span>)),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">completed =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">41</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">5</span>),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">45</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">2</span>),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">45</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">4</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">46</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">6</span>),</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">50</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">6</span>),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">196</span>)),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">adverse_event =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">41</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">2</span>), </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">45</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">1</span>), </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">45</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">2</span>), </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">46</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">2</span>), </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">50</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">2</span>), </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">196</span>)),</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">lack_of_efficacy =</span> <span class="fu">c</span>(</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">44</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">2</span>), </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">46</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>),  </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">47</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">1</span>), </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">50</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">1</span>), </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">54</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">2</span>),  </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">196</span>)),</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">other_reason_withdraw =</span> <span class="fu">c</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">46</span>), </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">47</span>),  </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">48</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>),  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">51</span>), <span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">1</span>),  </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">56</span>),  </span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">196</span>)),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">itt =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">250</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">196</span>)),</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">reason_itt =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">250</span>), <span class="fu">rep</span>(<span class="st">"No response"</span>, <span class="dv">196</span>)),</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">pp =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Yes"</span>, <span class="dv">250</span>), <span class="fu">rep</span>(<span class="st">"No"</span>, <span class="dv">196</span>)),</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">reason_pp =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">250</span>), <span class="fu">rep</span>(<span class="st">"No response"</span>, <span class="dv">196</span>))</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>)   <span class="ot">-&gt;</span> upa</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>upa <span class="sc">|&gt;</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">ordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Placebo"</span>, <span class="st">"Upa 7.5 mg QD"</span>, <span class="st">"Upa 15 mg QD"</span>, <span class="st">"Upa 30 mg QD"</span>, <span class="st">"Upa 45 mg QD"</span>))) <span class="ot">-&gt;</span> upa2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we will create the flowchart using the {flowchart} package. We will start with the opening box.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>upa_fc <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(upa_fc, <span class="at">max.level =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ data: tibble [446 × 15] (S3: tbl_df/tbl/data.frame)
 $ fc  : tibble [1 × 17] (S3: tbl_df/tbl/data.frame)
 - attr(*, "class")= chr "fc"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>upa_fc <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="branching" class="level2">
<h2 class="anchored" data-anchor-id="branching"><strong>Branching</strong></h2>
<p>Now we can add branching to the flowchart to document the exclusions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>upa2 <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>(<span class="at">label =</span> <span class="st">"Patients assessed for eligibility"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group), <span class="at">label =</span> <span class="st">"Randomized"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="splitting-into-groups-treatment-arms" class="level2">
<h2 class="anchored" data-anchor-id="splitting-into-groups-treatment-arms"><strong>Splitting into Groups (Treatment Arms)</strong></h2>
<p>Then we can start to split the branches to treatment arms (groups).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>upa2 <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>(<span class="at">label =</span> <span class="st">"Patients assessed for eligibility"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group), <span class="at">label =</span> <span class="st">"Randomized participants</span><span class="sc">\n</span><span class="st">Assigned to therapy"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Excluded patients"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_split</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="filtering-for-completers" class="level2">
<h2 class="anchored" data-anchor-id="filtering-for-completers"><strong>Filtering for Completers</strong></h2>
<p>Now let’s filter for completers but break this up so that we can also print out the fc object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>upa2 <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>(<span class="at">label =</span> <span class="st">"Patients assessed for eligibility"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group), <span class="at">label =</span> <span class="st">"Randomized participants</span><span class="sc">\n</span><span class="st">Assigned to therapy"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Excluded patients"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_split</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(completed <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">label =</span> <span class="st">"Completed Study"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Withdrew</span><span class="sc">\n</span><span class="st">from Study"</span>) <span class="ot">-&gt;</span> upa_fc4</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>upa_fc4<span class="sc">$</span>fc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 17
      id     x     y     n     N perc  text      type  group
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;
 1     1  0.5    0.8   446   446 100   "Patient… init  &lt;NA&gt; 
 2     2  0.5    0.6   250   446 56.05 "Randomi… filt… &lt;NA&gt; 
 3     3  0.65   0.7   196   446 43.95 "Exclude… excl… &lt;NA&gt; 
 4     4  0.1    0.4    46   250 18.4  "Placebo… split Plac…
 5     5  0.3    0.4    47   250 18.8  "Upa 7.5… split Upa …
 6     6  0.5    0.4    49   250 19.6  "Upa 15 … split Upa …
 7     7  0.7    0.4    52   250 20.8  "Upa 30 … split Upa …
 8     8  0.9    0.4    56   250 22.4  "Upa 45 … split Upa …
 9     9  0.1    0.2    41    46 89.13 "Complet… filt… Plac…
10    10  0.15   0.3     5    46 10.87 "Withdre… excl… Plac…
11    11  0.5    0.2    45    49 91.84 "Complet… filt… Upa …
12    12  0.55   0.3     4    49 8.16  "Withdre… excl… Upa …
13    13  0.7    0.2    46    52 88.46 "Complet… filt… Upa …
14    14  0.75   0.3     6    52 11.54 "Withdre… excl… Upa …
15    15  0.9    0.2    50    56 89.29 "Complet… filt… Upa …
16    16  0.95   0.3     6    56 10.71 "Withdre… excl… Upa …
17    17  0.3    0.2    45    47 95.74 "Complet… filt… Upa …
18    18  0.35   0.3     2    47 4.26  "Withdre… excl… Upa …
# ℹ 8 more variables: just &lt;chr&gt;, text_color &lt;chr&gt;,
#   text_fs &lt;dbl&gt;, text_fface &lt;dbl&gt;, text_ffamily &lt;lgl&gt;,
#   text_padding &lt;dbl&gt;, bg_fill &lt;chr&gt;, border_color &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>upa_fc4 <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>the next steps - improved exclusion labels.</p>
</section>
<section id="to-do--" class="level2">
<h2 class="anchored" data-anchor-id="to-do--">To do -</h2>
<p>Provide more detailed labels for the exclusions - use ‘withdrew consent’, ‘lost to follow-up’, ‘other reasons’ Add the discontinued reasons to the flowchart for each group -‘adverse event’, ‘lack of efficacy’, ‘other reasons’</p>
</section>
<section id="modify-exclusions-for-more-detailed-labels" class="level2">
<h2 class="anchored" data-anchor-id="modify-exclusions-for-more-detailed-labels">Modify exclusions for more detailed labels</h2>
<p>Let’s create the multiline text for the exclusions before randomization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>text_exc <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa<span class="sc">$</span>exclusion_crit <span class="sc">==</span> <span class="st">"Yes"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      upa<span class="sc">$</span>withdrew_consent <span class="sc">==</span> <span class="st">"Yes"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      upa<span class="sc">$</span>lost_to_follow_up <span class="sc">==</span> <span class="st">"Yes"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      upa<span class="sc">$</span>other_reasons <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa<span class="sc">$</span>exclusion_crit <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" met exclusion criteria</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa<span class="sc">$</span>withdrew_consent <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" withdrew their consent</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa<span class="sc">$</span>lost_to_follow_up <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" were lost to follow up</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa<span class="sc">$</span>other_reasons <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">" were excluded for other reasons"</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>text_exc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "196 patients excluded\n     172 met exclusion criteria\n     17 withdrew their consent\n     2 were lost to follow up\n     5 were excluded for other reasons"</code></pre>
</div>
</div>
<p>Now let’s add this multiline text for exclusions to the flowchart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>upa2 <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>(<span class="at">label =</span> <span class="st">"Patients assessed for eligibility"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group), <span class="at">label =</span> <span class="st">"Randomized participants</span><span class="sc">\n</span><span class="st">Assigned to therapy"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Excluded patients"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>( <span class="co">#modifying only box 3 - exclusions</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span><span class="dv">3</span>, text_exc, text),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">just =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">3</span>, <span class="st">"left"</span>, <span class="st">"center"</span>),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">3</span>, x <span class="sc">+</span> <span class="fl">0.11</span>, x)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_split</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(completed <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">label =</span> <span class="st">"Completed Study"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Withdrew</span><span class="sc">\n</span><span class="st">from Study"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="problems" class="level2">
<h2 class="anchored" data-anchor-id="problems"><strong>Problems</strong></h2>
<p>Don’t know the ids of the Withdrew from Study boxes? how would I find these out? Is there a way to look at the fc table? Is it 10,12,14,16,18? the fc portion of the list seems to have only one row? why is that? Shouldn’t it have rows for each id of each box? How do I see the full table? how do I control order of arms in fc_split - these should be in order by dose from placebo on left to the highest dose on right. Are these alphbetical ordered? Should I make group into an ordered factor to address this? For a SMART study (sequential multiple assignment randomized trial) - can I use fc_split to split by the first randomization and then again for the second randomization? How would I do this? Would I need to create a new group2 variable for this second randomization? When the withdrawal reasons re multiple, and the box is tall, is there an option to push the completed boxes lower down the page so that there is enough space for the withdrawal reasons?</p>
</section>
<section id="next-step" class="level2">
<h2 class="anchored" data-anchor-id="next-step"><strong>Next step</strong></h2>
<p>let’s add the withdrawal reasons to the flowchart for each group -‘adverse event’, ‘lack of efficacy’, ‘other reasons’</p>
<p>Create the multiline text for the withdrawal reasons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>upa_p <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"Placebo"</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>text_wd <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_p<span class="sc">$</span>completed <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_p<span class="sc">$</span>adverse_event <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" adverse event</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_p<span class="sc">$</span>lack_of_efficacy <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" lack of efficacy</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_p<span class="sc">$</span>other_reason_withdraw <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" other"</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>text_wd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "5 patients excluded\n     3 adverse event\n     2 lack of efficacy\n     0 other"</code></pre>
</div>
</div>
<p>Now for Upa 7.5 mg QD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>upa_7 <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"Upa 7.5 mg QD"</span>) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>text_wd2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_7<span class="sc">$</span>completed <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_7<span class="sc">$</span>adverse_event <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" adverse event</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_7<span class="sc">$</span>lack_of_efficacy <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" lack of efficacy</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_7<span class="sc">$</span>other_reason_withdraw <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" other"</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>text_wd2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2 patients excluded\n     1 adverse event\n     1 lack of efficacy\n     0 other"</code></pre>
</div>
</div>
<p>Now for Upa 15 mg QD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>upa_15 <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"Upa 15 mg QD"</span>) </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>text_wd3 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_15<span class="sc">$</span>completed <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_15<span class="sc">$</span>adverse_event <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" adverse event</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_15<span class="sc">$</span>lack_of_efficacy <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" lack of efficacy</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_15<span class="sc">$</span>other_reason_withdraw <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" other"</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>text_wd3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4 patients excluded\n     2 adverse event\n     1 lack of efficacy\n     1 other"</code></pre>
</div>
</div>
<p>Now for Upa 30 mg QD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>upa_30 <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"Upa 30 mg QD"</span>) </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>text_wd4 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_30<span class="sc">$</span>completed <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_30<span class="sc">$</span>adverse_event <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" adverse event</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_30<span class="sc">$</span>lack_of_efficacy <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" lack of efficacy</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_30<span class="sc">$</span>other_reason_withdraw <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" other"</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>text_wd4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "6 patients excluded\n     4 adverse event\n     1 lack of efficacy\n     1 other"</code></pre>
</div>
</div>
<p>Now for Upa 45 mg QD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>upa_45 <span class="ot">&lt;-</span> upa2 <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"Upa 45 mg QD"</span>) </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>text_wd5 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_45<span class="sc">$</span>completed <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">" patients excluded</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_45<span class="sc">$</span>adverse_event <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">" adverse event</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_45<span class="sc">$</span>lack_of_efficacy <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">" lack of efficacy</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"     "</span>, </span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(upa_45<span class="sc">$</span>other_reason_withdraw <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">" other"</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>text_wd5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "6 patients excluded\n     4 adverse event\n     2 lack of efficacy\n     0 other"</code></pre>
</div>
</div>
</section>
<section id="attempt-to-add-withdrawal-reasons" class="level2">
<h2 class="anchored" data-anchor-id="attempt-to-add-withdrawal-reasons">Attempt to add withdrawal reasons</h2>
<p>it looks like these are even numbers from 10 to 18</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>upa2 <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_fc</span>(<span class="at">label =</span> <span class="st">"Patients assessed for eligibility"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group), <span class="at">label =</span> <span class="st">"Randomized participants</span><span class="sc">\n</span><span class="st">Assigned to therapy"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Excluded patients"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>( <span class="co">#modifying only box 3 - exclusions</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span><span class="dv">3</span>, text_exc, text),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">just =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">3</span>, <span class="st">"left"</span>, just),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">3</span>, x <span class="sc">+</span> <span class="fl">0.11</span>, x)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_split</span>(group) <span class="sc">|&gt;</span> </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_filter</span>(completed <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">label =</span> <span class="st">"Completed Study"</span>, <span class="at">show_exc =</span> <span class="cn">TRUE</span>, <span class="at">label_exc =</span> <span class="st">"Withdrew</span><span class="sc">\n</span><span class="st">from Study"</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>(<span class="co"># moving group boxes leftward</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">17</span>), x<span class="fl">-0.02</span>, x)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>(<span class="co"># moving withdraw boxes leftward, down, resize font, align left</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>), x <span class="sc">-</span> <span class="fl">0.01</span>, x),</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>), y<span class="fl">-0.02</span>, y),</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">text_fs =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>), <span class="dv">8</span>, text_fs),</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">just =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>), <span class="st">"left"</span>, just)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">|&gt;</span> </span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>( <span class="co"># moving completers down</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">ifelse</span>(id <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">17</span>), y<span class="fl">-0.05</span>, y)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_modify</span>( <span class="co"># replacing text for one withdraw box</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> . <span class="sc">|&gt;</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">10</span>, text_wd, text),</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">18</span>, text_wd2, text),</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">12</span>, text_wd3, text),</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">14</span>, text_wd4, text),</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="dv">16</span>, text_wd5, text)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="ot">-&gt;</span> upa_fc6</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>upa_fc6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$data
# A tibble: 227 × 15
# Groups:   group [5]
      id inclusion_crit exclusion_crit withdrew_consent
   &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;           
 1     1 No             No             No              
 2     2 No             No             No              
 3     3 No             No             No              
 4     4 No             No             No              
 5     5 No             No             No              
 6     6 No             No             No              
 7     7 No             No             No              
 8     8 No             No             No              
 9     9 No             No             No              
10    10 No             No             No              
# ℹ 217 more rows
# ℹ 11 more variables: lost_to_follow_up &lt;chr&gt;,
#   other_reasons &lt;chr&gt;, group &lt;ord&gt;, completed &lt;chr&gt;,
#   adverse_event &lt;chr&gt;, lack_of_efficacy &lt;chr&gt;,
#   other_reason_withdraw &lt;chr&gt;, itt &lt;chr&gt;,
#   reason_itt &lt;chr&gt;, pp &lt;chr&gt;, reason_pp &lt;chr&gt;

$fc
# A tibble: 18 × 17
      id     x     y     n     N perc  text      type  group
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;
 1     1  0.5   0.8    446   446 100   "Patient… init  &lt;NA&gt; 
 2     2  0.5   0.6    250   446 56.05 "Randomi… filt… &lt;NA&gt; 
 3     3  0.76  0.7    196   446 43.95 "196 pat… excl… &lt;NA&gt; 
 4     4  0.08  0.4     46   250 18.4  "Placebo… split Plac…
 5     5  0.28  0.4     47   250 18.8  "Upa 7.5… split Upa …
 6     6  0.48  0.4     49   250 19.6  "Upa 15 … split Upa …
 7     7  0.68  0.4     52   250 20.8  "Upa 30 … split Upa …
 8     8  0.88  0.4     56   250 22.4  "Upa 45 … split Upa …
 9     9  0.08  0.15    41    46 89.13 "Complet… filt… Plac…
10    10  0.14  0.28     5    46 10.87 "5 patie… excl… Plac…
11    11  0.48  0.15    45    49 91.84 "Complet… filt… Upa …
12    12  0.54  0.28     4    49 8.16  "4 patie… excl… Upa …
13    13  0.68  0.15    46    52 88.46 "Complet… filt… Upa …
14    14  0.74  0.28     6    52 11.54 "6 patie… excl… Upa …
15    15  0.88  0.15    50    56 89.29 "Complet… filt… Upa …
16    16  0.94  0.28     6    56 10.71 "6 patie… excl… Upa …
17    17  0.28  0.15    45    47 95.74 "Complet… filt… Upa …
18    18  0.34  0.28     2    47 4.26  "2 patie… excl… Upa …
# ℹ 8 more variables: just &lt;chr&gt;, text_color &lt;chr&gt;,
#   text_fs &lt;dbl&gt;, text_fface &lt;dbl&gt;, text_ffamily &lt;lgl&gt;,
#   text_padding &lt;dbl&gt;, bg_fill &lt;chr&gt;, border_color &lt;chr&gt;

attr(,"class")
[1] "fc"</code></pre>
</div>
</div>
<p>Now let’s draw the flowchart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>upa_fc6 <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fc_draw</span>(<span class="at">box_corners =</span> <span class="st">"sharp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="upa_flowchart_consort_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>